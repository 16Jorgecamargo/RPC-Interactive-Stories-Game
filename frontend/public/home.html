<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Home - RPC Interactive Stories</title>
  <script src="/config.js"></script>
  <link rel="stylesheet" href="/src/styles/home.css">
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="greeting">
        OlÃ¡, <span class="username" id="username">UsuÃ¡rio</span>!
      </div>
      <button class="logout-btn" id="logoutBtn">Sair</button>
    </div>

    <div class="sessions-container">
      <h2 class="sessions-title">Minhas SessÃµes</h2>

      <div id="loadingMessage" class="loading">
        Carregando sessÃµes...
      </div>

      <div id="errorMessage" class="error-message" style="display: none;">
        Erro ao carregar sessÃµes. Por favor, tente novamente.
      </div>

      <div id="noSessions" class="no-sessions" style="display: none;">
        <div class="no-sessions-icon">ğŸ“</div>
        <h3>VocÃª ainda nÃ£o tem sessÃµes</h3>
        <p>Crie uma nova sessÃ£o ou entre em uma existente usando o cÃ³digo</p>
      </div>

      <div id="sessionsList" class="sessions-grid"></div>
      
      <div id="pagination" class="pagination" style="display: none;"></div>
    </div>

    <div class="actions-container">
      <button class="btn btn-primary" id="createSessionBtn">+ Criar SessÃ£o</button>
      <button class="btn btn-success" id="joinSessionBtn">Entrar em SessÃ£o</button>
    </div>
  </div>

  <script type="module">
    import { requireAuth, logout } from '/src/utils/auth.js';
    import { loadHome, renderHomeData } from '/src/ui/home.js';

    const loadingMessage = document.getElementById('loadingMessage');
    const errorMessage = document.getElementById('errorMessage');

    async function init() {
      const user = await requireAuth();

      if (!user) {
        return;
      }

      try {
        const homeData = await loadHome();
        loadingMessage.style.display = 'none';
        renderHomeData(homeData);
      } catch (error) {
        console.error('Erro ao carregar home:', error);
        loadingMessage.style.display = 'none';
        errorMessage.style.display = 'block';
      }
    }

    document.getElementById('logoutBtn').addEventListener('click', () => {
      logout();
      window.location.href = '/login.html';
    });

    document.getElementById('createSessionBtn').addEventListener('click', () => {
      alert('Funcionalidade "Criar SessÃ£o" serÃ¡ implementada na prÃ³xima sprint!');
    });

    document.getElementById('joinSessionBtn').addEventListener('click', () => {
      alert('Funcionalidade "Entrar em SessÃ£o" serÃ¡ implementada na prÃ³xima sprint!');
    });

    init();
  </script>
</body>
</html>
